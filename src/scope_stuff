

module StringMap = Map.Make(String)


// For every new scope:
[] @ [StringMap.empty]


let rec find = fun id scope level ->
	if level < 0 then
		// return not found here   "failwith" example in scanner/parser
	let myMap = scope.nth level in
		if StringMap.mem id myMap then
			StringMap.find id myMap
		else find id scope (level - 1)

let rec set = fun id value scope level ->
	let myMap = scope.nth level in
		StringMap.add id value myMap
